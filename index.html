<html><head>
    <script type="text/javascript">
      async function getDevice() {
        navigator.bluetooth
          .requestDevice({ filters: [{ services: [0x180f] }] })
          .then(device => {
            console.log('Connecting to GATT Server...');
            return device.gatt.connect();
          });
        var service = await devices.getPrimaryService(0x180f);
        var characteristic = await service.getCharacteristic(0x2a19);
        var batteryLevel = await characteristic.readValue();
        var value = batteryLevel.getUint8(0);
      }
      navigator.bluetooth
        .requestDevice({ filters: [{ services: [0x180f] }] })
        .then(device => device.gatt.connect())
        .then(server => server.getPrimaryService(0x180f))
        .then(service => service.getCharacteristic(0x2a19))
        .then(characteristic => characteristic.startNotifications())
        .then(characteristic => {
          // Set up event listener for when characteristic value changes.
          characteristic.addEventListener(
            'characteristicvaluechanged',
            handleBatteryLevelChanged
          );
          // Reading Battery Level...
          return characteristic.readValue();
        })
        .catch(error => {
          console.log(error);
        });

      function handleBatteryLevelChanged(event) {
        let batteryLevel = event.target.value.getUint8(0);
        console.log('Battery percentage is ' + batteryLevel);
      }
    </script>
  </head>

  <body>
    <button onclick="async function abc  (){
        await getDevice();
    }">
      enable bluetooth
    </button>
  

</body></html>
